<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HiChat Overlay</title>
    <style>
        body,
        html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: transparent;
        }

        #edit-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.4);
            /* 40% opacity black */
            z-index: 0;
            /* Background layer, behind sources */
            display: none;
            /* Hidden by default */
            pointer-events: none;
            /* Let clicks pass unless we want to block interaction with underlying desktop? Usually overlays pass through. But if "edit mode", likely block. */
        }

        /* If edit mode is active, we might want pointer events to be auto on this if it's meant to block interaction with desktop, 
           but the overlay window itself handles mouse events. 
           If this background is just visual, pointer-events: none is safer to avoid blocking interaction with the actual app elements (sources).
           However, usually "dim background" implies modal state. 
           Let's keep pointer-events: none for now because sources need to be interactive on top of it. */

        #overlay-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            /* Ensure sources are above the background */
            pointer-events: none;
            /* Let clicks pass through by default */
        }

        /* Source Wrapper */
        .source-wrapper {
            position: absolute;
            pointer-events: auto;
            /* Allow interaction with the wrapper (for drag/resize) if active */
            /* Default to none for content interaction, toggled by JS */
            pointer-events: none;
        }

        .source-wrapper.interactive {
            pointer-events: auto;
        }

        /* The Webview itself */
        webview {
            width: 100%;
            height: 100%;
            border: none;
            background: transparent;
        }

        /* Edit Mode Styles */
        .source-wrapper.editing {
            outline: 2px dashed #00b0ff;
            pointer-events: auto !important;
            /* Always interactive in edit mode */
            cursor: move;
        }

        .source-wrapper.editing::after {
            content: attr(data-name);
            position: absolute;
            top: -24px;
            left: 0;
            background: #00b0ff;
            color: white;
            padding: 2px 6px;
            font-size: 12px;
            border-radius: 4px;
            pointer-events: none;
            white-space: nowrap;
        }

        /* Resize Handles (only visible in edit mode) */
        .resize-handle {
            position: absolute;
            width: 10px;
            height: 10px;
            background: white;
            border: 1px solid #00b0ff;
            z-index: 10;
            display: none;
        }

        .source-wrapper.editing .resize-handle {
            display: block;
        }

        .resize-handle.nw {
            top: -5px;
            left: -5px;
            cursor: nw-resize;
        }

        .resize-handle.ne {
            top: -5px;
            right: -5px;
            cursor: ne-resize;
        }

        .resize-handle.sw {
            bottom: -5px;
            left: -5px;
            cursor: sw-resize;
        }

        .resize-handle.se {
            bottom: -5px;
            right: -5px;
            cursor: se-resize;
        }
    </style>
</head>

<body>
    <div id="edit-background"></div>
    <div id="overlay-canvas"></div>
    <script src="overlay-manager.js"></script>
</body>

</html>